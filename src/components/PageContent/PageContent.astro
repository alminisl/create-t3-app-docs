---
import Footer from "../Footer/Footer.astro";
import MoreMenu from "../RightSidebar/MoreMenu.astro";
import TableOfContents from "../RightSidebar/TableOfContents";
import PasteIcon from "../../components/PageContent/PasteIcon";
const { content, githubEditUrl, currentFile } = Astro.props;
const title = content.title;
const headings = content.astro.headings;
---

<div
  class="px-4 w-full h-full flex  flex-col items-start justify-between col-span-4 col-start-2"
>
  <div class="w-full">
    <h1 class="text-4xl font-semibold pb-12" id="overview">{title}</h1>
    <section class="mb-2 block sm:hidden">
      <nav class="">
        <TableOfContents {headings} />
      </nav>
    </section>
    <article class="markdown px-6 max-w-none">
      <slot />
    </article>
    <nav class="block lg:hidden">
      <MoreMenu editHref={githubEditUrl} />
    </nav>
  </div>
  <div class="w-full mx-auto pt-48">
    <Footer client:load path={currentFile} />
  </div>
</div>

<script>
  const copySVG = `<svg
    stroke="currentColor"
    fill="none"
    strokeWidth={0}
    viewBox="0 0 24 24"
    height="1.3em"
    width="1.3em"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      strokeLinecap="round"
      strokeLinejoin="round"
      strokeWidth={2}
      d="M8 5H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1M8 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M8 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2m0 0h2a2 2 0 0 1 2 2v3m2 4H10m0 0 3-3m-3 3 3 3"
    />
  </svg>`;

  let blocks = document.querySelectorAll("pre");
  blocks.forEach((block) => {
    block.className = "relative w-full";
    let copyButton = document.createElement("button");
    copyButton.className =
      "absolute right-1 top-1 border border-slate-50 rounded-lg px-2 py-1 text-sm hover:text-slate-800 hover:bg-gray-100 focus:outline-none focus:shadow-outline text-brand-primary";
    copyButton.innerHTML = copySVG;
    copyButton.addEventListener("click", () => {
      const pre = copyButton.parentElement;
      let code = pre.querySelector("code");
      let text = code.innerText;
      navigator.clipboard.writeText(text);
      copyButton.innerHTML = `<svg
    stroke="currentColor"
    fill="currentColor"
    strokeWidth={0}
    viewBox="0 0 1024 1024"
    height="1.3em"
    width="1.3em"
    xmlns="http://www.w3.org/2000/svg"
    {...props}
  >
    <path
      d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0 0 51.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"
      stroke="none"
    />
    <path
      d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"
      stroke="none"
    />
  </svg>`;
      setTimeout(() => {
        copyButton.innerHTML = copySVG;
      }, 1000);
    });
    block.appendChild(copyButton);
  });
</script>
